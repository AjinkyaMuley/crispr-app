"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.CollectionsOperation = void 0;
const collection_1 = require("../collection");
const operation_1 = require("./operation");
/** @internal */
<<<<<<< HEAD
class CollectionsOperation extends operation_1.AbstractCallbackOperation {
=======
<<<<<<< HEAD
class CollectionsOperation extends operation_1.AbstractCallbackOperation {
=======
class CollectionsOperation extends operation_1.AbstractOperation {
>>>>>>> 606e41d43ceed91f179614d13298418977dd016f
>>>>>>> 84c787a2e896c0e7a46e04aae83d200a1242e9bc
    constructor(db, options) {
        super(options);
        this.options = options;
        this.db = db;
    }
<<<<<<< HEAD
=======
<<<<<<< HEAD
>>>>>>> 84c787a2e896c0e7a46e04aae83d200a1242e9bc
    executeCallback(server, session, callback) {
        // Let's get the collection names
        this.db
            .listCollections({}, { ...this.options, nameOnly: true, readPreference: this.readPreference, session })
            .toArray()
            .then(documents => {
            const collections = [];
            for (const { name } of documents) {
                if (!name.includes('$')) {
                    // Filter collections removing any illegal ones
                    collections.push(new collection_1.Collection(this.db, name, this.db.s.options));
                }
            }
            // Return the collection objects
            callback(undefined, collections);
        }, error => callback(error));
<<<<<<< HEAD
=======
=======
    async execute(server, session) {
        // Let's get the collection names
        const documents = await this.db
            .listCollections({}, { ...this.options, nameOnly: true, readPreference: this.readPreference, session })
            .toArray();
        const collections = [];
        for (const { name } of documents) {
            if (!name.includes('$')) {
                // Filter collections removing any illegal ones
                collections.push(new collection_1.Collection(this.db, name, this.db.s.options));
            }
        }
        // Return the collection objects
        return collections;
>>>>>>> 606e41d43ceed91f179614d13298418977dd016f
>>>>>>> 84c787a2e896c0e7a46e04aae83d200a1242e9bc
    }
}
exports.CollectionsOperation = CollectionsOperation;
//# sourceMappingURL=collections.js.map